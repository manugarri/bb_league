{% extends "base.html" %}

{% block title %}{{ _('Blood Bowl League Tracker') }} - {{ _('Home') }}{% endblock %}

{% block content %}
<!-- Hero Section -->
<div class="hero text-center rounded mb-5">
    <h1 class="display-4 fw-bold text-gold mb-3">
        <i class="bi bi-trophy-fill text-blood"></i> {{ _('Blood Bowl League Tracker') }}
    </h1>
    <p class="lead text-muted mb-4">
        {% if get_locale() == 'es' %}
        ¡Gestiona tus ligas, controla tus equipos y domina el campo!
        {% else %}
        Manage your leagues, track your teams, and dominate the pitch!
        {% endif %}
    </p>
    {% if not current_user.is_authenticated %}
    <div class="d-flex justify-content-center gap-3">
        <a href="{{ url_for('auth.register') }}" class="btn btn-primary btn-lg">
            <i class="bi bi-person-plus me-2"></i>{% if get_locale() == 'es' %}Únete Ahora{% else %}Join Now{% endif %}
        </a>
        <a href="{{ url_for('auth.login') }}" class="btn btn-outline-secondary btn-lg">
            <i class="bi bi-box-arrow-in-right me-2"></i>{{ _('Login') }}
        </a>
    </div>
    {% else %}
    <div class="d-flex justify-content-center gap-3">
        <a href="{{ url_for('teams.create') }}" class="btn btn-primary btn-lg">
            <i class="bi bi-plus-circle me-2"></i>{{ _('Create Team') }}
        </a>
        {% if current_user.is_admin %}
        <a href="{{ url_for('leagues.create') }}" class="btn btn-secondary btn-lg">
            <i class="bi bi-trophy me-2"></i>{{ _('Create League') }}
        </a>
        {% endif %}
    </div>
    {% endif %}
</div>

<div class="row g-4">
    <!-- Active Leagues -->
    <div class="col-lg-6">
        <div class="card h-100">
            <div class="card-header d-flex justify-content-between align-items-center">
                <span><i class="bi bi-trophy me-2"></i>{{ _('Active Leagues') }}</span>
                <a href="{{ url_for('leagues.index') }}" class="btn btn-sm btn-outline-secondary">{% if get_locale() == 'es' %}Ver Todas{% else %}View All{% endif %}</a>
            </div>
            <div class="card-body">
                {% if active_leagues %}
                <div class="list-group list-group-flush">
                    {% for league in active_leagues %}
                    <a href="{{ url_for('leagues.view', league_id=league.id) }}" class="list-group-item list-group-item-action bg-transparent border-bottom border-secondary">
                        <div class="d-flex w-100 justify-content-between align-items-center">
                            <div>
                                <h6 class="mb-1 text-gold">{{ league.name }}</h6>
                                <small class="text-muted">
                                    <i class="bi bi-person me-1"></i>{{ league.commissioner.username }} · 
                                    <i class="bi bi-people me-1"></i>{{ league.team_count }}/{{ league.max_teams }} {{ _('Teams').lower() }}
                                </small>
                            </div>
                            <span class="badge {% if league.status == 'registration' %}bg-success{% elif league.status == 'active' %}bg-warning{% else %}bg-secondary{% endif %}">
                                {% if get_locale() == 'es' %}
                                    {% if league.status == 'registration' %}Inscripción{% elif league.status == 'active' %}Activa{% elif league.status == 'completed' %}Completada{% else %}{{ league.status | capitalize }}{% endif %}
                                {% else %}
                                    {{ league.status | capitalize }}
                                {% endif %}
                            </span>
                        </div>
                    </a>
                    {% endfor %}
                </div>
                {% else %}
                <p class="text-muted text-center py-4">
                    <i class="bi bi-inbox display-4 d-block mb-2"></i>
                    {% if get_locale() == 'es' %}No hay ligas activas aún. ¡Sé el primero en crear una!{% else %}No active leagues yet. Be the first to create one!{% endif %}
                </p>
                {% endif %}
            </div>
        </div>
    </div>
    
    <!-- Recent Matches -->
    <div class="col-lg-6">
        <div class="card h-100">
            <div class="card-header d-flex justify-content-between align-items-center">
                <span><i class="bi bi-calendar-event me-2"></i>{{ _('Recent Matches') }}</span>
                <a href="{{ url_for('matches.index') }}" class="btn btn-sm btn-outline-secondary">{% if get_locale() == 'es' %}Ver Todos{% else %}View All{% endif %}</a>
            </div>
            <div class="card-body">
                {% if recent_matches %}
                <div class="list-group list-group-flush">
                    {% for match in recent_matches %}
                    <a href="{{ url_for('matches.view', match_id=match.id) }}" class="list-group-item list-group-item-action bg-transparent border-bottom border-secondary">
                        <div class="d-flex justify-content-between align-items-center">
                            <div class="text-end flex-grow-1">
                                <span class="{% if match.home_score > match.away_score %}text-gold fw-bold{% endif %}">
                                    {{ match.home_team.name }}
                                </span>
                            </div>
                            <div class="px-3">
                                <span class="badge bg-dark fs-6">
                                    {{ match.home_score }} - {{ match.away_score }}
                                </span>
                            </div>
                            <div class="text-start flex-grow-1">
                                <span class="{% if match.away_score > match.home_score %}text-gold fw-bold{% endif %}">
                                    {{ match.away_team.name }}
                                </span>
                            </div>
                        </div>
                        <small class="text-muted d-block text-center mt-1">
                            {% if match.league %}{{ match.league.name }} · {% endif %}
                            {{ _('Round') }} {{ match.round_number or 'N/A' }}
                        </small>
                    </a>
                    {% endfor %}
                </div>
                {% else %}
                <p class="text-muted text-center py-4">
                    <i class="bi bi-calendar-x display-4 d-block mb-2"></i>
                    {% if get_locale() == 'es' %}No hay partidos jugados aún.{% else %}No matches played yet.{% endif %}
                </p>
                {% endif %}
            </div>
        </div>
    </div>
</div>

{% if current_user.is_authenticated and user_teams %}
<!-- Your Teams -->
<div class="card mt-4">
    <div class="card-header d-flex justify-content-between align-items-center">
        <span><i class="bi bi-shield-fill me-2"></i>{{ _('My Teams') }}</span>
        <a href="{{ url_for('teams.create') }}" class="btn btn-sm btn-primary">
            <i class="bi bi-plus me-1"></i>{% if get_locale() == 'es' %}Nuevo Equipo{% else %}New Team{% endif %}
        </a>
    </div>
    <div class="card-body">
        <div class="row g-3">
            {% for team in user_teams %}
            <div class="col-md-4">
                <div class="card bg-dark">
                    <div class="card-body">
                        <h5 class="card-title text-gold">{{ team.name }}</h5>
                        <p class="card-text">
                            <span class="badge bg-secondary">{{ tr_race(team.race.name) }}</span>
                            <span class="text-muted">{{ _('TV (Team Value)') }}: {{ "{:,}".format(team.current_tv) }}</span>
                        </p>
                        <div class="d-flex justify-content-between align-items-center">
                            <span class="text-muted small">
                                {{ team.roster_count }}/16 {{ _('Players').lower() }}
                            </span>
                            <a href="{{ url_for('teams.view', team_id=team.id) }}" class="btn btn-sm btn-outline-primary">
                                {% if get_locale() == 'es' %}Ver Equipo{% else %}View Team{% endif %}
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endif %}

<!-- Features Section -->
<div class="row g-4 mt-4">
    <div class="col-md-4">
        <div class="card text-center h-100">
            <div class="card-body py-5">
                <i class="bi bi-people-fill display-3 text-blood mb-3"></i>
                <h4 class="text-gold">{% if get_locale() == 'es' %}Gestiona Equipos{% else %}Manage Teams{% endif %}</h4>
                <p class="text-muted">
                    {% if get_locale() == 'es' %}
                    Crea tu equipo, contrata jugadores, rastrea estadísticas y míralos crecer a través de la liga.
                    {% else %}
                    Create your team, hire players, track stats and watch them grow through the league.
                    {% endif %}
                </p>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card text-center h-100">
            <div class="card-body py-5">
                <i class="bi bi-trophy display-3 text-gold mb-3"></i>
                <h4 class="text-gold">{% if get_locale() == 'es' %}Organiza Ligas{% else %}Run Leagues{% endif %}</h4>
                <p class="text-muted">
                    {% if get_locale() == 'es' %}
                    Organiza ligas de todos contra todos, genera calendarios y rastrea clasificaciones automáticamente.
                    {% else %}
                    Organize round-robin leagues, generate schedules, and track standings automatically.
                    {% endif %}
                </p>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card text-center h-100">
            <div class="card-body py-5">
                <i class="bi bi-bar-chart-fill display-3 text-blood mb-3"></i>
                <h4 class="text-gold">{% if get_locale() == 'es' %}Rastrea Estadísticas{% else %}Track Stats{% endif %}</h4>
                <p class="text-muted">
                    {% if get_locale() == 'es' %}
                    Estadísticas detalladas de jugadores, equipos y partidos. ¡Mira quién es el más letal en el campo!
                    {% else %}
                    Detailed statistics for players, teams, and matches. See who's the deadliest on the pitch!
                    {% endif %}
                </p>
            </div>
        </div>
    </div>
</div>
{% endblock %}
