{% extends "base.html" %}

{% block title %}Blood Bowl League Tracker - Home{% endblock %}

{% block content %}
<!-- Hero Section -->
<div class="hero text-center rounded mb-5">
    <h1 class="display-4 fw-bold text-gold mb-3">
        <i class="bi bi-trophy-fill text-blood"></i> Blood Bowl League Tracker
    </h1>
    <p class="lead text-muted mb-4">
        Manage your leagues, track your teams, and dominate the pitch!
    </p>
    {% if not current_user.is_authenticated %}
    <div class="d-flex justify-content-center gap-3">
        <a href="{{ url_for('auth.register') }}" class="btn btn-primary btn-lg">
            <i class="bi bi-person-plus me-2"></i>Join Now
        </a>
        <a href="{{ url_for('auth.login') }}" class="btn btn-outline-secondary btn-lg">
            <i class="bi bi-box-arrow-in-right me-2"></i>Login
        </a>
    </div>
    {% else %}
    <div class="d-flex justify-content-center gap-3">
        <a href="{{ url_for('teams.create') }}" class="btn btn-primary btn-lg">
            <i class="bi bi-plus-circle me-2"></i>Create Team
        </a>
        <a href="{{ url_for('leagues.create') }}" class="btn btn-secondary btn-lg">
            <i class="bi bi-trophy me-2"></i>Create League
        </a>
    </div>
    {% endif %}
</div>

<div class="row g-4">
    <!-- Active Leagues -->
    <div class="col-lg-6">
        <div class="card h-100">
            <div class="card-header d-flex justify-content-between align-items-center">
                <span><i class="bi bi-trophy me-2"></i>Active Leagues</span>
                <a href="{{ url_for('leagues.index') }}" class="btn btn-sm btn-outline-secondary">View All</a>
            </div>
            <div class="card-body">
                {% if active_leagues %}
                <div class="list-group list-group-flush">
                    {% for league in active_leagues %}
                    <a href="{{ url_for('leagues.view', league_id=league.id) }}" class="list-group-item list-group-item-action bg-transparent border-bottom border-secondary">
                        <div class="d-flex w-100 justify-content-between align-items-center">
                            <div>
                                <h6 class="mb-1 text-gold">{{ league.name }}</h6>
                                <small class="text-muted">
                                    <i class="bi bi-person me-1"></i>{{ league.commissioner.username }} · 
                                    <i class="bi bi-people me-1"></i>{{ league.team_count }}/{{ league.max_teams }} teams
                                </small>
                            </div>
                            <span class="badge {% if league.status == 'registration' %}bg-success{% elif league.status == 'active' %}bg-warning{% else %}bg-secondary{% endif %}">
                                {{ league.status | capitalize }}
                            </span>
                        </div>
                    </a>
                    {% endfor %}
                </div>
                {% else %}
                <p class="text-muted text-center py-4">
                    <i class="bi bi-inbox display-4 d-block mb-2"></i>
                    No active leagues yet. Be the first to create one!
                </p>
                {% endif %}
            </div>
        </div>
    </div>
    
    <!-- Recent Matches -->
    <div class="col-lg-6">
        <div class="card h-100">
            <div class="card-header d-flex justify-content-between align-items-center">
                <span><i class="bi bi-calendar-event me-2"></i>Recent Matches</span>
                <a href="{{ url_for('matches.index') }}" class="btn btn-sm btn-outline-secondary">View All</a>
            </div>
            <div class="card-body">
                {% if recent_matches %}
                <div class="list-group list-group-flush">
                    {% for match in recent_matches %}
                    <a href="{{ url_for('matches.view', match_id=match.id) }}" class="list-group-item list-group-item-action bg-transparent border-bottom border-secondary">
                        <div class="d-flex justify-content-between align-items-center">
                            <div class="text-end flex-grow-1">
                                <span class="{% if match.home_score > match.away_score %}text-gold fw-bold{% endif %}">
                                    {{ match.home_team.name }}
                                </span>
                            </div>
                            <div class="px-3">
                                <span class="badge bg-dark fs-6">
                                    {{ match.home_score }} - {{ match.away_score }}
                                </span>
                            </div>
                            <div class="text-start flex-grow-1">
                                <span class="{% if match.away_score > match.home_score %}text-gold fw-bold{% endif %}">
                                    {{ match.away_team.name }}
                                </span>
                            </div>
                        </div>
                        <small class="text-muted d-block text-center mt-1">
                            {% if match.league %}{{ match.league.name }} · {% endif %}
                            Round {{ match.round_number or 'N/A' }}
                        </small>
                    </a>
                    {% endfor %}
                </div>
                {% else %}
                <p class="text-muted text-center py-4">
                    <i class="bi bi-calendar-x display-4 d-block mb-2"></i>
                    No matches played yet.
                </p>
                {% endif %}
            </div>
        </div>
    </div>
</div>

{% if current_user.is_authenticated and user_teams %}
<!-- Your Teams -->
<div class="card mt-4">
    <div class="card-header d-flex justify-content-between align-items-center">
        <span><i class="bi bi-shield-fill me-2"></i>Your Teams</span>
        <a href="{{ url_for('teams.create') }}" class="btn btn-sm btn-primary">
            <i class="bi bi-plus me-1"></i>New Team
        </a>
    </div>
    <div class="card-body">
        <div class="row g-3">
            {% for team in user_teams %}
            <div class="col-md-4">
                <div class="card bg-dark">
                    <div class="card-body">
                        <h5 class="card-title text-gold">{{ team.name }}</h5>
                        <p class="card-text">
                            <span class="badge bg-secondary">{{ team.race.name }}</span>
                            <span class="text-muted">TV: {{ "{:,}".format(team.current_tv) }}</span>
                        </p>
                        <div class="d-flex justify-content-between align-items-center">
                            <span class="text-muted small">
                                {{ team.roster_count }}/16 players
                            </span>
                            <a href="{{ url_for('teams.view', team_id=team.id) }}" class="btn btn-sm btn-outline-primary">
                                View Team
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endif %}

<!-- Features Section -->
<div class="row g-4 mt-4">
    <div class="col-md-4">
        <div class="card text-center h-100">
            <div class="card-body py-5">
                <i class="bi bi-people-fill display-3 text-blood mb-3"></i>
                <h4 class="text-gold">Manage Teams</h4>
                <p class="text-muted">Create your team, hire players, track stats and watch them grow through the league.</p>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card text-center h-100">
            <div class="card-body py-5">
                <i class="bi bi-trophy display-3 text-gold mb-3"></i>
                <h4 class="text-gold">Run Leagues</h4>
                <p class="text-muted">Organize round-robin leagues, generate schedules, and track standings automatically.</p>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card text-center h-100">
            <div class="card-body py-5">
                <i class="bi bi-bar-chart-fill display-3 text-blood mb-3"></i>
                <h4 class="text-gold">Track Stats</h4>
                <p class="text-muted">Detailed statistics for players, teams, and matches. See who's the deadliest on the pitch!</p>
            </div>
        </div>
    </div>
</div>
{% endblock %}

